// 3rd_party_lib:formula/target/release/formula
//3rd_party_lib_ohos:formula\target\aarch64-linux-ohos\release\formula
import formula.*
import std.unittest.*
import std.collection.*
import std.fs.*

@Test
public class test {                //r.draw(g2, 0, 0, 0xFF0000FF) 异常
    @TestCase
    func test4(): Unit {

    var latex = LaTeX("res")
    var str = ###"
\sideset{^\backprime}{'}
\sum_{x=1}^{\infty} x
\sideset{a_1^2}{}\sum_{x=1}^\infty x_0
\\
\sideset{_\text{left bottom}'''}{_{\text{right bottom}}'''}
\sum_{\text{quite long text}}^\infty x
\\
\sideset{}{'}
\sum_{n<k,\;\text{$n$ odd}} nE_n
\\
\sideset{}{'}
\sum^{n<k,\;\text{$n$ odd}} nE_n
\\
M_x''' M'''_x M^{'''}_x M_x{'''} M^{\prime\backprime}
"###

    var r = latex.parse(str, 2000000000, 40.0, 10.0, 0xFF000000)  //0xFF00FF00绿色               //0xFF000000黑色
    var w = r.getWidth()
    var h = r.getHeight()
    println(w)
    println(h)
    var g2 = Graphic2D(r,COLOR_FORMAT_BGRA_8888)
    r.draw(g2,0xFF0000FF)  //0xFFFF0000 红色  背景色   0xFF0000FF蓝色   r.draw(g2, 384, 558, 0xFF0000FF) 
    var arr = r.toBitmap(g2)
    var file: File = File("test.bmp", OpenOption.CreateOrTruncate(false))
    file.write(arr)
    file.close()

    }
}